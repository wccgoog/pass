import time,pymysql,cx_Oracle,urllib,httplib2,json
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
#Oracle查询所有事项
jdbc=cx_Oracle.connect('XZSPJBXQ/XZJSXZSP@10.196.109.221:1521/ORCL',encoding = "UTF-8",nencoding = "UTF-8")
oracle=jdbc.cursor()
#oracle链接
oracle.execute("SELECT	XZSPJBXQ.XJL_XZSP_APPLICATION. ID,	XZSPJBXQ.XJL_XZSP_APPLICATION.OFFICE_NUMBER,	XZSPJBXQ.XJL_XZSP_APPLICATION.CASEFLOW_ID,	XZSPJBXQ.XJL_XZSP_APPLICATION.TRANS_ID,	XZSPJBXQ.XJL_XZSP_APPLICATION.TRANS_CODE,	XZSPJBXQ.XJL_XZSP_APPLICATION.TRANS_NAME,	XZSPJBXQ.XJL_XZSP_APPLICATION.TRANSACTION_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLICANT_NAME,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLICANT_DOCUMENT_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLICANT_DOCUMENT_NUMBER,	XZSPJBXQ.XJL_XZSP_APPLICATION.AGENT_NAME,	XZSPJBXQ.XJL_XZSP_APPLICATION.AGENT_DOCUMENT_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.AGENT_DOCUMENT_NUMBER,	XZSPJBXQ.XJL_XZSP_APPLICATION.POSTCODE,	XZSPJBXQ.XJL_XZSP_APPLICATION.ADDRESS,	XZSPJBXQ.XJL_XZSP_APPLICATION.LEGAL_REPRESENTATIVE,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLY_SOURCE,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLY_TIME,	XZSPJBXQ.XJL_XZSP_APPLICATION.PROJECT_NUMBER,	XZSPJBXQ.XJL_XZSP_APPLICATION.CREATE_BY,	XZSPJBXQ.XJL_XZSP_APPLICATION.CREATE_DATE,	XZSPJBXQ.XJL_XZSP_APPLICATION.UPDATE_BY,	XZSPJBXQ.XJL_XZSP_APPLICATION.UPDATE_DATE,	XZSPJBXQ.XJL_XZSP_APPLICATION.REMARKS,	XZSPJBXQ.XJL_XZSP_APPLICATION.DEL_FLAG,	XZSPJBXQ.XJL_XZSP_APPLICATION.STATUS,	XZSPJBXQ.XJL_XZSP_APPLICATION.CALL_FLAG,	XZSPJBXQ.XJL_XZSP_APPLICATION.CHECK_STATUS,	XZSPJBXQ.XJL_XZSP_APPLICATION.PROMISE_DATE,	XZSPJBXQ.XJL_XZSP_APPLICATION.DOCUMENT_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.EXPRESS_ID,	XZSPJBXQ.XJL_XZSP_APPLICATION.PICKUP_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.TEL_PHONE,	XZSPJBXQ.XJL_XZSP_APPLICATION.BEFORE_STATUS,	XZSPJBXQ.XJL_XZSP_APPLICATION.PHONE,	XZSPJBXQ.XJL_XZSP_APPLICATION.CONCRETE_TRANS,	XZSPJBXQ.XJL_XZSP_APPLICATION.CHECK_MESSAGE,	XZSPJBXQ.XJL_XZSP_APPLICATION.MESSAGE,	XZSPJBXQ.XJL_XZSP_APPLICATION.CONCLUDEDDATE,	XZSPJBXQ.XJL_XZSP_APPLICATION.APPLICANTPRSON_TYPE,	XZSPJBXQ.XJL_XZSP_APPLICATION.GONGCHENGMIANJI,	XZSPJBXQ.XJL_XZSP_APPLICATION.GONGCHENGZAOJIA,	XZSPJBXQ.XJL_XZSP_APPLICATION.CASEFLOW_ID_FA,	XZSPJBXQ.XJL_XZSP_APPLICATION.FLOW_STATUS,	XZSPJBXQ.XJL_XZSP_APPLICATION.BAPP_ID,	XZSPJBXQ.XJL_XZSP_APPLICATION.SYNC_STATUS,	XZSPJBXQ.XJL_XZSP_APPLICATION.THEME_ID,	UCENTER.SYS_OFFICE. NAME FROM	XZSPJBXQ.XJL_XZSP_APPLICATION,	XZSPJBXQ.XJL_XZSP_TRANS,	UCENTER.SYS_OFFICE WHERE	XZSPJBXQ.XJL_XZSP_APPLICATION.TRANS_ID = XZSPJBXQ.XJL_XZSP_TRANS. ID AND XZSPJBXQ.XJL_XZSP_TRANS.OFFICE_ID = UCENTER.SYS_OFFICE. ID AND UCENTER.SYS_OFFICE. ID = '9a7c4229d22e449d8ec900162921f74e'")
a=oracle.fetchall()
print(a)

#连接mysql
conn=pymysql.connect(host='10.196.109.221',user='root',password='ztesoft',database='jbzw')
mysql=conn.cursor()
#sg_sp_work
mysql.execute("INSERT INTO `jbzw`.`sg_sp_work` (`ID`, `INSTANCE_ID`, `HOLDER_NO`, `WORK_NO`, `QUERY_NO`, `WORK_TYPE`, `ORG_ID`, `ORG_NAME`, `ITEM_OR_THEME_ID`, `APPLICANT_TYPE`, `APPLICANT_CERT_TYPE`, `APPLICANT_CERT_NO`, `APPLICANT_NAME`, `GENDER`, `SELF_MATERIAL_ID`, `BIRTH_DATE`, `MOBILE_PHONE`, `FIXED_PHONE`, `EMAIL`, `ADDRESS`, `IS_AGENT`, `APPLY_SOURCE`, `STATE`, `APPLY_TIME`, `PROMISE_DATE`, `CREATE_USER`, `CREATE_DATE`, `UPDATE_USER`, `UPDATE_DATE`, `COMMENTS`, `DATA_SOURCE`, `OUT_WORK_NO`, `ITEM_CODE`, `ITEM_NAME`, `APPLICANT_ZIP_CODE`, `PROJECT_CODE`, `LEGAL_REPRESENTATIVE`, `ORG_CODE`, `AREA_ID`, `AREA_NAME`, `AREA_CODE`, `ACCEPTANCE_TIME`, `END_TIME`, `RECEIVE_ADDRESS`, `RELATION_PHONE`, `SUPERVISE_PHONE`, `ACCEPTANCE_PROMISE_DATE`, `ACCEPTANCE_WARING_DATE`, `WARING_DATE`, `PROJECT_ID`, `CUSTOMER_DATA_ID`, `CUSTOMER_FORM_CODE`, `CUSTOMER_FORM_NAME`, `ITEM_BASIC_CODE`, `ITEM_IMPLE_CODE`, `PROJECT_NAME`) VALUES ('595603995294425088', 'f12eb14b-0955-11e9-84ce-fa163e03a802', '20181227053400000807136', '201812260837951', '1812260039915', '2', '18340', '城管环保审批办', '595592730624737280', '1', 'A01', '33212719920623072X', '张璐', 'M', NULL, '1992-06-23', '15537852707', NULL, '1111112236@qq.com', '昆明市西山区11111', 'N', '02', '04-02-01', '2018-12-26 15:52:33', '2019-01-05 23:59:59', NULL, '2018-12-26 15:52:33', '32681', '2018-12-26 16:33:53', NULL, NULL, NULL, '11000380013201110000032011108000', '占用、挖掘城市道路审批（属门坡、道口工程）', NULL, NULL, NULL, '00032011108', '1', '江北新区', '32011100', '2018-12-26 16:34:07', '2018-12-26 16:34:26', NULL, NULL, NULL, '2018-12-31 23:59:59', '2018-12-29 23:59:59', '2018-12-31 23:59:59', NULL, '37212970096807424', '99409151041', '占用、挖掘城市道路审批（属门坡、道口工程）', '1100038001', '3201110000032011108000', NULL)")
#bpm_task_holder
mysql.execute("INSERT INTO `jbzw`.`bpm_task_holder` (`holder_id`, `holder_no`, `process_ver_id`, `process_name`, `proc_inst_id`, `business_key`, `holder_state`, `creator_id`, `last_modify_user`, `holder_state_date`, `start_time`, `end_time`, `delete_reason`, `simu_flag`) VALUES ('c5461261-c14b-4e4f-b14e-bfe24a5919e2', '20190124084545000475774', '105', '省级通用流程', '5d67a653-1f71-11e9-be09-fa163e03a802', '1e80c96b-b282-4058-888e-3138039c39f2', 'A', '32709', NULL, '2019-01-23 19:45:37', '2019-01-23 19:45:37', '0000-00-00 00:00:00', NULL, '0');")
mysql.execute("")
application=mysql.fetchall()
